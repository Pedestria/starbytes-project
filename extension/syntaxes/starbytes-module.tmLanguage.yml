name: "Starbytes Module File Syntax"
scopeName: "source.strmodule" 
# uuid: 347f9b27-fc68-4a5c-8659-f7a4b8d7a33e
fileTypes: ["strmodule"]
foldingStartMarker: '\:$'
foldingStopMarker: '^\s*(?=module|dump|get|to)'

variables:
  ID: '\w+'
  keywords: module|dump|get|to

patterns:
  - name: "strmodule.module"
    begin: '\b(module)\b +({{ID}})\:$'
    end: '^(?={{keywords}})'
    beginCaptures:
      '1':
        name: 'keyword.control.strmodule.module'
      '2':
        name: 'support.class'
    patterns:
      - name: "module.config-entry"
        begin: '^\s*\b({{ID}})\b *\:'
        end: '^\s*(?={{ID}})'
        beginCaptures:
          '1':
            name: 'variable.readwrite'
        patterns:
          - include: "#string-literal"
          - include: "#identifier"
          - name: "config-entry.array"
            begin: '\['
            end: '\]$'
            patterns:
              - include: "#identifier"
  - name: "strmodule.dump"
    begin: '\b(dump)\b +(\*|{{ID}}) +\b(to)\b'
    end: '^(?={{keywords}})'
    beginCaptures:
      '1':
        name: 'keyword.control.strmodule.dump'
      '2':
        name: 'variable.readwrite'
      '3':
        name: 'keyword.control.strmodule.to'
    patterns:
      - include: "#string-literal"
  - name: "strmodule.get"
    match: '\b(get)\b +({{ID}})'
    captures:
      '1':
        name: 'keyword.control.strmodule.get'
      '2':
        name: 'support.class'
      
    

repository:
  string-literal:
    name: "string.quoted.double.strmodule"
    begin: '"'
    end: '"'
    patterns:
      - name: 'constant.character.escape.strmodule'
        match: '\\.'
  identifier:
    name: "config-entry.id"
    match: '\b({{ID}})\b'
    captures:
      '1':
        name: 'variable.readwrite'



